<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- this stylesheet is for dojo dijit style (claro specifically) -->
    <link
      rel="stylesheet"
      href="http://ajax.googleapis.com/ajax/libs/dojo/1.10.4/dijit/themes/claro/claro.css"
      media="screen"
    />

    <!-- CSS -->
    <style></style>

    <title>SWC</title>
  </head>

  <!-- in order for the dijit style to apply you have to link a class to the body -->
  <body class="claro">
    <h2 id="header">
      Click this button to get a card of a random Star Wars character
    </h2>
    <button id="btn">Click me!</button>

    <!-- Dojo CDN Script -->
    <!-- http: IMPORTANT -->
    <script
      src="http://ajax.googleapis.com/ajax/libs/dojo/1.14.1/dojo/dojo.js"
      data-dojo-config="has:{'dojo-firebug': true}, parseOnLoad: true, foo: 'bar', async: 1"
    ></script>

    <!-- Dojo Script -->
    <script>
      require([
        "dojo/dom",
        "dojo/on",
        "dojo/request/xhr",
        "dijit/Dialog",
        "dojo/domReady!",
      ], function (dom, on, xhr, dialog) {
        var btn = dom.byId("btn");
        var header = dom.byId("header");

        on(btn, "click", function () {
          var num;

          // this loop is to avoid getting #17 since it's not in the api!
          while (true) {
            num = Math.floor(Math.random() * 83) + 1;
            if (num !== 17) break;
          }

          // this block of code will fetch api data and handle it as a json obj
          xhr(`https://swapi.dev/api/people/${num}/`, {
            handleAs: "json",
          }).then(
            function (obj) {
              // do something with the obj
              // displaying the json data on a dialog
              var dataDialog = new dialog({
                title: `${obj.name} &ensp; #${num}`,
                style: "width: 200px",
                content: `<div>
                            <p>height: ${obj.height}</p>
                            <p>mass: ${obj.mass}</p>
                            <p>hair color: ${obj.hair_color}</p>
                            <p>skin color: ${obj.skin_color}</p>
                            <p>eye color: ${obj.eye_color}</p>
                            <p>birth year: ${obj.birth_year}</p>
                            <p>gender: ${obj.gender}</p>
                          </div>`,
              });

              dataDialog.show();
            },
            function (err) {
              // Handle the error condition
              header.innerHTML = "ERR";
            }
          );
        });
      });
    </script>
  </body>
</html>
